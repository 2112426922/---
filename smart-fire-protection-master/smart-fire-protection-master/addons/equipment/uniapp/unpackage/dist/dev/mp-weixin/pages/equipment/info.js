(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/equipment/info"],{109:function(n,e,t){"use strict";(function(n,e){var i=t(4);t(26);i(t(25));var o=i(t(110));n.__webpack_require_UNI_MP_PLUGIN__=t,e(o.default)}).call(this,t(1)["default"],t(2)["createPage"])},110:function(n,e,t){"use strict";t.r(e);var i=t(111),o=t(113);for(var a in o)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return o[n]}))}(a);t(115);var r,c=t(32),u=Object(c["default"])(o["default"],i["render"],i["staticRenderFns"],!1,null,null,null,!1,i["components"],r);u.options.__file="pages/equipment/info.vue",e["default"]=u.exports},111:function(n,e,t){"use strict";t.r(e);var i=t(112);t.d(e,"render",(function(){return i["render"]})),t.d(e,"staticRenderFns",(function(){return i["staticRenderFns"]})),t.d(e,"recyclableRender",(function(){return i["recyclableRender"]})),t.d(e,"components",(function(){return i["components"]}))},112:function(n,e,t){"use strict";var i;t.r(e),t.d(e,"render",(function(){return o})),t.d(e,"staticRenderFns",(function(){return r})),t.d(e,"recyclableRender",(function(){return a})),t.d(e,"components",(function(){return i}));var o=function(){var n=this,e=n.$createElement,t=(n._self._c,n.info.todos.length),i=n.info.records.length;n.$mp.data=Object.assign({},{$root:{g0:t,g1:i}})},a=!1,r=[];o._withStripped=!0},113:function(n,e,t){"use strict";t.r(e);var i=t(114),o=t.n(i);for(var a in i)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return i[n]}))}(a);e["default"]=o.a},114:function(n,e,t){"use strict";(function(n,t){var i;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o="",a=!1,r=!1,c={data:function(){return{info:{},type:"repair"}},onLoad:function(e){if(i=this,!e.coding)return i.tui.toast("未知设备"),void setTimeout((function(){n.navigateBack()}),1500);"type"in e&&(i.type=e.type),o=e.coding,a=!!getApp().globalData.token,i.getInfo()},methods:{getInfo:function(){n.showLoading({title:"查询中..."}),i.$api.equipment({coding:o}).then((function(e){n.hideLoading(),i.info=e.data,i.changeColor(e.data.work_status),n.setNavigationBarTitle({title:e.data.archive_name+" "+e.data.archive_model})})).catch((function(e){n.hideLoading(),i.tui.toast(e.msg)}))},changeColor:function(e){var t="#25ac66";switch(e){case"sickness":t="#ea9003";break;case"repairing":t="#dd0000";break;case"scrapped":t="#999999";break;case"normal":default:t="#25ac66";break}n.setNavigationBarColor({frontColor:"#ffffff",backgroundColor:t})},call:function(e){""!=e&&n.makePhoneCall({phoneNumber:e})},viewDocument:function(e){if(""!=e){var t=e.slice(-4);".pdf"==t?(n.showLoading({title:"加载中...",mask:!0}),n.downloadFile({url:e,success:function(e){if(200===e.statusCode){var t=e.tempFilePath;n.openDocument({filePath:t,fileType:"pdf",success:function(n){},fail:function(n){i.tui.toast("文档加载失败")},complete:function(){n.hideLoading()}})}else n.hideLoading(),i.tui.toast("文档加载失败")},fail:function(e){n.hideLoading(),i.tui.toast("文档加载失败")}})):n.previewImage({urls:[e]})}},repair:function(){r||(r=!0,a?i.goRepair():t.login({success:function(n){n.code?i.goWeLogin(n.code):i.tipLogin()},fail:function(n){i.tipLogin()}}))},goRepair:function(){r=!1,n.navigateTo({url:"/pages/repair/repair?equipment_id="+i.info.id,events:{doRefresh:function(e){e&&e.ischange&&(i.getInfo(),n.$emit("manageRefresh",{ischange:!0}))}}})},repairInfo:function(e){n.$once("repairChange",(function(e){e&&e.ischange&&(i.getInfo(),n.$emit("manageRefresh",{ischange:!0}))})),n.navigateTo({url:"/pages/repair/info?id="+e})},planTodo:function(e,t){n.navigateTo({url:"/pages/plan/dotask?id="+e+"&type="+t,events:{doRefresh:function(e){e&&e.ischange&&(i.getInfo(),n.$emit("manageRefresh",{ischange:!0}))}}})},recordInfo:function(e,t){"inspection"!==t&&"maintenance"!==t||n.navigateTo({url:"/pages/plan/info?id="+e+"&type="+t}),"repair"===t&&n.navigateTo({url:"/pages/repair/record?id="+e})},goWeLogin:function(e){i.$api.welogin({code:e}).then((function(e){a=!0,getApp().globalData.token=e.data.token,n.setStorageSync("equipment_token",e.data.token),n.setStorageSync("equipment_openid",e.data.openid),n.$emit("loginStatusEvent",{isLogin:!0}),i.goRepair()})).catch((function(n){i.tipLogin()}))},tipLogin:function(){r=!1,n.showModal({title:"提示",content:"还未登录账号，无法进行本次操作",confirmText:"登录",cancelColor:"#8799a3",confirmColor:"#333333",success:function(e){e.confirm&&n.navigateTo({url:"/pages/login/login",events:{isLoginFromLogin:function(n){n&&n.isLogin&&(a=!0)}}})}})}}};e.default=c}).call(this,t(2)["default"],t(1)["default"])},115:function(n,e,t){"use strict";t.r(e);var i=t(116),o=t.n(i);for(var a in i)["default"].indexOf(a)<0&&function(n){t.d(e,n,(function(){return i[n]}))}(a);e["default"]=o.a},116:function(n,e,t){}},[[109,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/equipment/info.js.map