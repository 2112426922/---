(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mine/manage"],{85:function(n,t,e){"use strict";(function(n,t){var o=e(4);e(26);o(e(25));var a=o(e(86));n.__webpack_require_UNI_MP_PLUGIN__=e,t(a.default)}).call(this,e(1)["default"],e(2)["createPage"])},86:function(n,t,e){"use strict";e.r(t);var o=e(87),a=e(89);for(var i in a)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return a[n]}))}(i);e(91);var u,c=e(32),r=Object(c["default"])(a["default"],o["render"],o["staticRenderFns"],!1,null,null,null,!1,o["components"],u);r.options.__file="pages/mine/manage.vue",t["default"]=r.exports},87:function(n,t,e){"use strict";e.r(t);var o=e(88);e.d(t,"render",(function(){return o["render"]})),e.d(t,"staticRenderFns",(function(){return o["staticRenderFns"]})),e.d(t,"recyclableRender",(function(){return o["recyclableRender"]})),e.d(t,"components",(function(){return o["components"]}))},88:function(n,t,e){"use strict";var o;e.r(t),e.d(t,"render",(function(){return a})),e.d(t,"staticRenderFns",(function(){return u})),e.d(t,"recyclableRender",(function(){return i})),e.d(t,"components",(function(){return o}));var a=function(){var n=this,t=n.$createElement;n._self._c},i=!1,u=[];a._withStripped=!0},89:function(n,t,e){"use strict";e.r(t);var o=e(90),a=e.n(o);for(var i in o)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(i);t["default"]=a.a},90:function(n,t,e){"use strict";(function(n,e){var o,a;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={data:function(){return{login:!1,user:{},avatar:"",managePhone:""}},onShow:function(){o.login||(a=!!getApp().globalData.token,a&&(o.login=a,o.getStaffInfo()))},onLoad:function(t){o=this,a=!!getApp().globalData.token,o.login=a,a?o.getStaffInfo():n.login({success:function(n){n.code&&o.goWeLogin(n.code)}}),o.getSystemInfo()},methods:{getSystemInfo:function(){o.$api.getSystemInfo().then((function(n){o.managePhone=n.data.manage_phone})).catch((function(n){}))},getStaffInfo:function(){e.showLoading({title:"加载中..."}),o.$api.getStaffInfo().then((function(n){e.hideLoading(),o.user=n.data,o.avatar=n.data.avatar})).catch((function(n){e.hideLoading(),o.tui.toast(n.msg)}))},goWeLogin:function(n){o.$api.welogin({code:n}).then((function(n){getApp().globalData.token=n.data.token,getApp().globalData.equipmentManage=n.data.equipment_manage,e.setStorageSync("equipment_token",n.data.token),e.setStorageSync("equipment_openid",n.data.openid),e.setStorageSync("equipment_manage",n.data.equipment_manage),o.login=!0,o.getStaffInfo()})).catch((function(n){}))},goLogin:function(){e.navigateTo({url:"/pages/login/login",events:{isLoginFromLogin:function(n){n&&n.isLogin&&(o.login=!0,o.getStaffInfo())}}})},logout:function(){e.showModal({title:"提示",content:"是否确认要操作退出登录？",success:function(n){n.confirm&&o.doLogout()}})},doLogout:function(){e.showLoading({title:"退出中..."}),o.$api.logout().then((function(n){e.hideLoading(),o.clearStorage()})).catch((function(n){e.hideLoading(),o.clearStorage()}))},clearStorage:function(){try{o.login=!1,getApp().globalData.token="",getApp().globalData.equipmentManage=0,e.setStorageSync("equipment_token",""),e.setStorageSync("equipment_openid",""),e.setStorageSync("equipment_manage",""),e.$emit("loginStatusEvent",{isLogin:!1}),o.tui.toast("退出登录成功")}catch(n){o.tui.toast("退出失败，请稍后再试")}},callManage:function(){var n=o.managePhone;""!=n?e.makePhoneCall({phoneNumber:n}):o.tui.toast("暂无管理员联系方式")}}};t.default=i}).call(this,e(1)["default"],e(2)["default"])},91:function(n,t,e){"use strict";e.r(t);var o=e(92),a=e.n(o);for(var i in o)["default"].indexOf(i)<0&&function(n){e.d(t,n,(function(){return o[n]}))}(i);t["default"]=a.a},92:function(n,t,e){}},[[85,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/mine/manage.js.map