(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/repair/register"],{133:function(e,t,n){"use strict";(function(e,t){var i=n(4);n(26);i(n(25));var a=i(n(134));e.__webpack_require_UNI_MP_PLUGIN__=n,t(a.default)}).call(this,n(1)["default"],n(2)["createPage"])},134:function(e,t,n){"use strict";n.r(t);var i=n(135),a=n(137);for(var r in a)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(r);n(139);var u,c=n(32),o=Object(c["default"])(a["default"],i["render"],i["staticRenderFns"],!1,null,null,null,!1,i["components"],u);o.options.__file="pages/repair/register.vue",t["default"]=o.exports},135:function(e,t,n){"use strict";n.r(t);var i=n(136);n.d(t,"render",(function(){return i["render"]})),n.d(t,"staticRenderFns",(function(){return i["staticRenderFns"]})),n.d(t,"recyclableRender",(function(){return i["recyclableRender"]})),n.d(t,"components",(function(){return i["components"]}))},136:function(e,t,n){"use strict";var i;n.r(t),n.d(t,"render",(function(){return a})),n.d(t,"staticRenderFns",(function(){return u})),n.d(t,"recyclableRender",(function(){return r})),n.d(t,"components",(function(){return i}));var a=function(){var e=this,t=e.$createElement;e._self._c},r=!1,u=[];a._withStripped=!0},137:function(e,t,n){"use strict";n.r(t);var i=n(138),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=a.a},138:function(e,t,n){"use strict";(function(e){var i=n(4);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,r=i(n(38)),u=0,c=!1,o={data:function(){return{content:"",imgList:{fullurl:"",url:""},imgUpload:!1,statusIndex:0,statusPicker:["已维修","停机报废"],statusArr:["repaired","scrapped"],causePicker:[],causeIdArr:[],causeIndex:0}},onLoad:function(t){if(a=this,!t.repair_id)return a.tui.toast("未知维修工单"),void setTimeout((function(){e.navigateBack()}),1500);u=t.repair_id,a.failureCause()},methods:{failureCause:function(){a.$api.failureCause().then((function(e){var t=e.data,n=[],i=[];t.forEach((function(e,t){n.push(e.id),i.push(e.name)})),a.causeIdArr=n,a.causePicker=i}))},pickerChange:function(e){this.statusIndex=e.detail.value},causeChange:function(e){this.causeIndex=e.detail.value},chooseImage:function(){e.chooseImage({count:1,sizeType:["original","compressed"],success:function(t){var n=t.tempFilePaths;e.uploadFile({url:r.default.host+"api/common/upload",filePath:n[0],name:"file",header:{token:e.getStorageSync("equipment_token")},success:function(e){var t=JSON.parse(e.data);a.imgUpload=!0,a.imgList=t.data},fail:function(){a.imgUpload=!1,a.tui.toast("图片上传失败")}})}})},viewImage:function(t){e.previewImage({urls:[a.imgList.fullurl],current:t.currentTarget.dataset.url})},delImg:function(){e.showModal({title:"提示",content:"确定要删除这张照片吗？",cancelText:"再看看",confirmText:"确定",cancelColor:"#8799a3",confirmColor:"#333333",success:function(e){e.confirm&&(a.imgList={},a.imgUpload=!1)}})},textareaInput:function(e){a.content=e.detail.value},submit:function(){c||(u?""!=a.content?(e.showLoading({title:"提交中..."}),a.$api.register({repair_id:u,failure_cause_id:a.causeIdArr[a.causeIndex],repair_content:a.content,repair_image:a.imgList.url,repair_status:a.statusArr[a.statusIndex]}).then((function(t){c=!1,e.hideLoading(),a.tui.toast("登记成功","","success"),setTimeout((function(){e.$emit("repairChange",{ischange:!0,type:"repair"}),e.navigateBack({delta:2})}),1500)})).catch((function(t){c=!1,e.hideLoading(),a.tui.toast(t.msg)}))):a.tui.toast("维修说明不能为空"):a.tui.toast("未知报修记录"))}}};t.default=o}).call(this,n(2)["default"])},139:function(e,t,n){"use strict";n.r(t);var i=n(140),a=n.n(i);for(var r in i)["default"].indexOf(r)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(r);t["default"]=a.a},140:function(e,t,n){}},[[133,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/repair/register.js.map